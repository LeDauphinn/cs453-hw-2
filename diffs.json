{"https://github.com/NationalSecurityAgency/ghidra/pull/6302.diff": "diff --git a/Ghidra/Features/Base/src/main/java/ghidra/app/util/opinion/MachoProgramBuilder.java b/Ghidra/Features/Base/src/main/java/ghidra/app/util/opinion/MachoProgramBuilder.java\nindex 3ea9c5c61ff..4cddc7ea563 100644\n--- a/Ghidra/Features/Base/src/main/java/ghidra/app/util/opinion/MachoProgramBuilder.java\n+++ b/Ghidra/Features/Base/src/main/java/ghidra/app/util/opinion/MachoProgramBuilder.java\n@@ -998,7 +998,7 @@ else if (loadCommand instanceof LinkerOptionCommand) {\n \n \t/**\n \t * Sets up the {@link MachHeader} in memory and returns its address.  If the header was not \n-\t * intended to reside in memory (like for Mach-O object files}, then this method will create an \n+\t * intended to reside in memory (like for Mach-O object files), then this method will create an\n \t * area in the \"OTHER\" address space for the header to live in.\n \t * \n \t * @param segments A {@link Collection} of {@link SegmentCommand Mach-O segments}\n@@ -1011,12 +1011,15 @@ protected Address setupHeaderAddr(Collection<SegmentCommand> segments)\n \t\tlong lowestFileOffset = Long.MAX_VALUE;\n \n \t\t// Check to see if the header resides in an existing segment.  If it does, we know its\n-\t\t// address and we are done.  Keep track of the lowest file offset of later use.\n+\t\t// address and we are done.  Keep track of the lowest file offset for later use.\n \t\tfor (SegmentCommand segment : segments) {\n-\t\t\tif (segment.getFileOffset() == 0 && segment.getFileSize() > 0) {\n-\t\t\t\treturn space.getAddress(segment.getVMaddress());\n+\t\t\tif (segment.getFileOffset() == 0) {\n+\t\t\t\tif (segment.getFileSize() > 0) {\n+\t\t\t\t\treturn space.getAddress(segment.getVMaddress());\n+\t\t\t\t}\n+\t\t\t} else {\n+\t\t\t\tlowestFileOffset = Math.min(lowestFileOffset, segment.getFileOffset());\n \t\t\t}\n-\t\t\tlowestFileOffset = Math.min(lowestFileOffset, segment.getFileOffset());\n \t\t}\n \n \t\t// The header did not live in a defined segment.  Create a memory region in the OTHER space \n", "https://github.com/NationalSecurityAgency/ghidra/pull/6331.diff": "diff --git a/GPL/DemanglerGnu/build.gradle b/GPL/DemanglerGnu/build.gradle\nindex 174747549f1..7a56684947a 100644\n--- a/GPL/DemanglerGnu/build.gradle\n+++ b/GPL/DemanglerGnu/build.gradle\n@@ -82,6 +82,7 @@ model {\n \t\t\ttargetPlatform \"mac_x86_64\"\n \t\t\ttargetPlatform \"mac_arm_64\"\n \t\t\ttargetPlatform \"freebsd_x86_64\"\n+\t\t\ttargetPlatform \"freebsd_arm_64\"\n \t\t\tsources {\n \t\t\t\tc {\n \t\t\t\t\tsource {\n@@ -104,6 +105,7 @@ model {\n \t\t\ttargetPlatform \"mac_x86_64\"\n \t\t\ttargetPlatform \"mac_arm_64\"\n \t\t\ttargetPlatform \"freebsd_x86_64\"\n+\t\t\ttargetPlatform \"freebsd_arm_64\"\n \t\t\tsources {\n \t\t\t\tc {\n \t\t\t\t\tsource {\ndiff --git a/GPL/nativeBuildProperties.gradle b/GPL/nativeBuildProperties.gradle\nindex 6ba0409b6ac..e3494203350 100644\n--- a/GPL/nativeBuildProperties.gradle\n+++ b/GPL/nativeBuildProperties.gradle\n@@ -54,7 +54,11 @@ model {\n \t\t}\n \t\tif (isCurrentFreeBSD()) {\n \t\t\tgcc(Gcc) {\n-\t\t\t\ttarget(\"freebsd_x86_64\")\n+\t\t\t\tif (isCurrentArm_64()) {\n+\t\t\t\t\ttarget(\"freebsd_arm_64\")\n+\t\t\t\t} else {\n+\t\t\t\t\ttarget(\"freebsd_x86_64\")\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tif (isCurrentWindows() && VISUAL_STUDIO_INSTALL_DIR) {\ndiff --git a/GPL/nativePlatforms.gradle b/GPL/nativePlatforms.gradle\nindex 24d540f10aa..0a2c02a2d2d 100644\n--- a/GPL/nativePlatforms.gradle\n+++ b/GPL/nativePlatforms.gradle\n@@ -25,7 +25,8 @@ project.ext.PLATFORMS = [\n \t[name: \"linux_arm_64\", os: \"linux\", arch: \"arm64\"],\n \t[name: \"mac_x86_64\", os: \"osx\", arch: \"x86_64\"],\n \t[name: \"mac_arm_64\", os: \"osx\", arch: \"arm64\"],\n-\t[name: \"freebsd_x86_64\", os: \"freebsd\", arch: \"x86_64\"]\n+\t[name: \"freebsd_x86_64\", os: \"freebsd\", arch: \"x86_64\"],\n+\t[name: \"freebsd_arm_64\", os: \"freebsd\", arch: \"arm64\"]\n ]\n \n /*********************************************************************************\ndiff --git a/Ghidra/Features/Decompiler/buildNatives.gradle b/Ghidra/Features/Decompiler/buildNatives.gradle\nindex 62bd81d2669..26ffd0d0dfa 100644\n--- a/Ghidra/Features/Decompiler/buildNatives.gradle\n+++ b/Ghidra/Features/Decompiler/buildNatives.gradle\n@@ -43,6 +43,7 @@ model {\n \t\t\ttargetPlatform \"mac_x86_64\"\n \t\t\ttargetPlatform \"mac_arm_64\"\n \t\t\ttargetPlatform \"freebsd_x86_64\"\n+\t\t\ttargetPlatform \"freebsd_arm_64\"\n \t\t\tsources {\n \t\t\t\tcpp {\n \t\t\t\t\t// NOTE: The bison/flex generated files are assumed to be up-to-date.\n@@ -149,6 +150,7 @@ model {\n \t\t\ttargetPlatform \"mac_x86_64\"\n \t\t\ttargetPlatform \"mac_arm_64\"\n \t\t\ttargetPlatform \"freebsd_x86_64\"\n+\t\t\ttargetPlatform \"freebsd_arm_64\"\n \t\t\tsources {\n \t\t\t\tcpp {\n \t\t\t\t\t// NOTE: The bison/flex generated files are assumed to be up-to-date.\ndiff --git a/Ghidra/Framework/Generic/src/main/java/ghidra/framework/Platform.java b/Ghidra/Framework/Generic/src/main/java/ghidra/framework/Platform.java\nindex 68f5d476fbc..a283cdb9536 100644\n--- a/Ghidra/Framework/Generic/src/main/java/ghidra/framework/Platform.java\n+++ b/Ghidra/Framework/Generic/src/main/java/ghidra/framework/Platform.java\n@@ -70,6 +70,11 @@ public enum Platform {\n \t */\n \tFREEBSD_X86_64(OperatingSystem.FREE_BSD, Architecture.X86_64, \"freebsd_x86_64\", \".so\", \"\"),\n \n+\t/**\n+\t * Identifies a FreeBSD ARM 64-bit OS.\n+\t */\n+\tFREEBSD_ARM_64(OperatingSystem.FREE_BSD, Architecture.ARM_64, \"freebsd_arm_64\", \".so\", \"\"),\n+\n \t/**\n \t * Identifies an unsupported OS.\n \t */\ndiff --git a/GhidraDocs/InstallationGuide.html b/GhidraDocs/InstallationGuide.html\nindex 3c47400b846..75bfed9bfdc 100644\n--- a/GhidraDocs/InstallationGuide.html\n+++ b/GhidraDocs/InstallationGuide.html\n@@ -317,6 +317,7 @@ <h2><a name=\"Build\"></a>Building Ghidra Native Components</h2>\n <ul>\n   <li>Linux ARM 64-bit</li>\n   <li>FreeBSD x86 64-bit (no debugger support)</li>\n+  <li>FreeBSD arm 64-bit (no debugger support)</li>\n </ul>\n <p>In order to build native binaries for your platform, you will need the following installed on your\n system:</p>\n"}